@page "/showModel"
@using Common.Data
@using Common.Models;

<!--  Browser tab title  -->
<PageTitle>Master & Detail</PageTitle>

<div class="container-fluid h100 m-0 p-0">  
    <!-- Greeting Message -->
    <TopBanner BannerTxt="Build and Show Model"></TopBanner>

    <div class="container h60 CenterCol">       
        <div class="row estilo round-border" style="background-image: linear-gradient(to bottom right, #003300 40%, #005b00 60% );">
            <div class="col-lg-8 InvBanner StartRow m-0" >
                <h3 style=""> Importadora South Winds - Invoice</h3>
            </div>
            <div class="col-md-2 flexCol">
                <label>Number</label>
                <input type="number" style="width:100%;text-align:center;" @bind="Inv.Header.InvoiceNumber" />                
            </div>
            <div class="col-md-2 flexCol">
                <label>Date</label>
                <input type="date"  style="width:100%;" @bind="Inv.Header.InvoiceDate" /> 
            </div>
        </div>
        <div class="row estilo" style="border-style: solid;border-top:none;">
            <div class="col-md-8 flexCol" >
                <label>Cliente</label>
                <input type="text" style="width:100%"  @bind="Inv.Header.Buyer" />                
            </div>
            <div class="col-md-2 flexCol">
                <label>CPF </label>
                <input type="Text" style="width:100%"  @bind="Inv.Header.Cpf" />               
            </div>
            <div class="col-md-2 flexCol">  
                 <label>Controls</label>
                 <input type="Text" style="width:100%" /> 
            </div>

            <div class="col-md-8 flexCol">
                <label>Address</label>
                <input type="Text" style="width:100%" @bind="Inv.Header.Address" />                
            </div>

            <div class="col-md-2 flexCol">
                <label>Complemento</label>
                <input type="Text" style="width:100%" value=@Inv.Header?.Complto/>                
            </div>
            <div class="col-md-2 flexCol">
                <label>Phone</label>
                <input type="Text" style="width:100%" value=@Inv.Header?.Phone/>                
            </div>
        </div>

        <!-- Move records to table-->
        <div class="row estilo @fade m-0 p-0 " style="border-style:solid;border-top:none;" >  
            @if ( Inv.Lines[0] is not null )
            {
                <ItemsPad Act="@Inv.Lines[0]" />  
            }                        
        </div>
               
        <!-- Move records to table-->
        <div class="row estilo m-0 p-0" style="background-color:whitesmoke;border-style:solid;border-top:none;" >
            <div class="col-md-12 mt-2 flexCol">
                <table class="table table-striped table-bordered table-secondary table-hover" >
                    <thead>
                        <tr>
                                <th style="text-align:center">Item</th>
                                <th style="text-align:center">Description</th>
                                <th style="text-align:center">Qtty</th>
                                <th style="text-align:center">Unit Price</th>
                                <th style="text-align:center">Total</th>
                                <th style="text-align:center">Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        @for (int i = 0; i < Inv.Lines?.Count; i++)
                        {
                            <tr>
                                <td style="text-align:right">@Inv.Lines[i].ItemNumber</td>
                                <td style="text-align:left" >@Inv.Lines[i].Description</td>
                                <td style="text-align:right">@Inv.Lines[i].Qtty.ToString("N0")</td>
                                <td style="text-align:right">@Inv.Lines[i].UnitPrice.ToString("N2")</td>
                                <td style="text-align:right">@((Inv.Lines[i].Qtty * Inv.Lines[i].UnitPrice).ToString("N2"))</td>
                                <td style="text-align:center"> 
                                    <!-- Para uso futuro - Update and Delete buttons -->
                                    @*<button type="button" class="btn btn-labeled btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#myModal " 
                                        > Update </button>
                                        <button type="button" class="btn btn-labeled btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#myModal " 
                                        > Delete </button>*@
                                </td>
                            </tr>
                        }               
                    </tbody>
                </table>
            </div>
            <div class="col-md-12 CenterRow pb-2 pt-2">                
                <button type="button" class="btn btn-labeled btn-primary btn-sm" @onclick="CheckModelData"> Insert New Invoice </button>
                <button type="button" class="btn btn-labeled btn-primary btn-sm" @onclick="ShowItemPad"> Edit Current Invoice </button>
            </div>
        </div>
    </div>
</div>

<style>
    .h20 { height: 20%; }
    .h30 { height: 30%; }
    .h60 { height: 60%; }
    .h70 { height: 70%; }
    .h90 { height: 90%; }
    .h100 { height: 100%; }
    h2 {         
        font-family : 'Montserrat';
        font-size: 2em;
    }
    h3 {         
        font-family : 'Montserrat';
        font-size: 1.5em;
    }
    .estilo{   
        width: 100%;
        border-width: 2px;
        border-style: none;
        border-top: none;
        border-color: green;
        padding-bottom: 6px;         
    }
    .fadein{
        max-height:          0;
        transition:          max-height;
        transition-delay :   0ms;
        transition-duration: 1200ms;
    }
    .fadeout{
        max-height:          60px;
        transition:          max-height;
        transition-delay :   200ms;
        transition-duration: 1800ms;
    }
    .round-border{
        border: solid 1px green;
        border-top-left-radius:10px;
        border-top-right-radius:10px;
    }
    .StartRow{
        display:         flex;
        flex-direction:  row;
        align-items:     center;
        justify-content: start;
    }

    .StartCol{
        display:         flex;
        flex-direction:  column;
        align-items:     start;
        justify-content: center;
    }

    .CenterCol{
        display:         flex;
        flex-direction:  column;
        align-items:     center;
        justify-content: center;
    }
    .CenterRow{
        display:         flex;
        flex-direction:  row;
        align-items:     center;
        justify-content: space-around;
    }
    .InvBanner{        
        height: 60px;        
        color:  white;
        padding-top:   15px;
        padding-left:   27px;
    }
    .flexCol{          
        display:         flex;
        flex-direction:  column;
        align-items:     start;
        justify-content: center;
        color:  black;
    }
    label{
        font-size: 12px;
        color : red;
    }
</style>

@code{
    public Invoice Inv { get; set; } = SampleData.CreateInvoice();   //  Populates model with hard coded sample data

    public bool Visible = false;
    public string fade = "fadein";

    protected override void OnInitialized() => base.OnInitialized();     

    private void CheckModelData() {}

    private void ShowItemPad()
    {   
        Visible = !Visible;
        fade = Visible ? "fadeout" : "fadein";
    }
}